# GNS3_Projects
Simulation of GRE Tunneling, IPSec protocol and running GRE over IPSEC using GNS3 software
TOPIC : BITCOIN NETWORK ( PEER TO PEER PROTOCOL & IPSEC)  

The bitcoin network is a peer-to-peer payment network that operates on a cryptographic protocol.  
We have implemented 3 projects of IPSec and peer to peer protocol so that we demonstrate the different possibilities of packet travel and security. Here, all hosts are connected to eachother without any server in between any 2 hosts. The following terms were some of the main terms we came across while working on the projects.   
IPSec (IPSecurity) IPsec is a protocol suite that encrypts the entire IP traffic before the packets are transferred from the source node to the destination. IPsec is also capable and responsible for authenticating the identities of the two nodes before the actual communication takes place between them. IPsec can be configured to use any of the available algorithms to encrypt and decrypt the network traffic.  
IPsec can be configured to work in either of the two available modes:  Transport Mode – In Transport Mode, IPsec only encrypts and/or authenticates the actual payload of the packet, and the header information remains intact.  Tunnel Mode – In Tunnel Mode, IPsec encrypts and/or authenticates the entire packet. After encryption, the packet is then encapsulated to form a new IP packet that has different header information. IPsec is configured to be used in Tunnel Mode while setting up secure site-to-site VPN tunnels.  
IPSec defines 2 protocols –    Authentication Protocol (AH) – Designed to authenticate the source host and to ensure the integrity of the payload carried in the IP packet. The protocol uses a hash function and a symmetric key to create a message digest. The digest is inserted in the AH. The AH is then placed in the appropriate location based on mode (transport or tunnel).  Encapsulating Security Payload (ESP)  - Provides source   authentication, integrity and privacy which is not provided by AH.  
We have implemented IPSec with tunnel mode and have used ESP.     
 ISAKMP (Internet Security Association and Key Management Protocol) ISAKMP is a protocol designed by the NSA that actually implements the exchanges in IKE (Internet Key Exchange). It defines several packets, protocols, and parameters that allow IKE exchanges.   
VPN (Virtual Private Network) VPN  is a network that is constructed by using public wires — usually the Internet — to connect to a private network, such as s company’s internal network. A VPN is designed to provides a secure, encrypted tunnel in which to transmit the data between the remote user and the company network. The information transmitted between the two locations via the encrypted tunnel cannot be read by anyone else because the system contains several elements to secure both the company's private network and the outside network through which the remote user connects through.   
VPN technology uses IPSec in the tunnel mode to provide authentication, integrity and privacy. Each IP datagram destined for private use in the organisation is encapsulated in another datagram. The Internet is responsibe=le for carrying the packet from source router to destination router. Outsiders cannot decipher the contents of the packet or the source and destination addresses. Deciphering takes place at the destination router which finds the destination address of the packet and delivers it.   
GRE (Generic Routing Encapsulation) GRE provides a private, secure path for transporting packets through an otherwise public network by encapsulating (or tunnelling) the packets.  GRE encapsulates data packets and redirects them to a device that de-encapsulates them and routes them to their final destination. This allows the source and destination switches to operate as if they have a virtual point-to-point connection with each other (because the outer header applied by GRE is transparent to the encapsulated payload packet). For example, GRE tunnels allow routing protocols such as RIP and OSPF to forward data packets from one switch to another switch across the Internet.  
GRE Tunnelling -  Data is routed by the system to the GRE endpoint over routes established in the route table. (These routes can be statically configured or dynamically learned by routing protocols such as RIP or OSPF.) When a data packet is received by the GRE endpoint, it is de-encapsulated and routed again to its destination address.            
PROJECTS :  
1) Site-to-Site IPSEC VPN   
 The source computer C1 forwards the packet P1 with the destination IP address of the computer C2 to the router R2 (default gateway).  The router R2 receives the packet P1 and encrypts the entire packet using the specified algorithm.  After encrypting the packet, the router R2 encapsulates the whole packet to form a new packet NP1. This packet has IP address of R2 as source IP and the IP address of the router R3 (the router placed at the destination location) as the destination IP.  The router R2 then forwards the packet NP1 to the IP address of R3 using the Internet.  The destination router R3 receives the packet.  The router R3 decapsulates the NP1 to get the original packet P1.  The router R3 decrypts the packet P1 using the appropriate algorithm.  The router R3 then forwards the packet P1 to the destination computer C2, where the packet was actually supposed to reach.  
Steps-  1. Configure all IP addresses as specified in the topology picture 2. Configure a loopback interface on Router R2 and R3 R2: Loopback0: 1.1.1.1 /24 R3: Loopback0: 3.3.3.3 /24 3. Configure OSPF on all 3 routers and advertise the following networks: 192.168.12.0 /24 192.168.23.0 /24 1.1.1.0 /24 3.3.3.0 /24 4. Ensure Router R2 and R3 can ping each other 5. Ensure you can ping 3.3.3.3 from R2, sourced from its Loopback0 interface. 6. configure an IPSEC connection between Router R2 and R3 7. Create a ISAKMP policy: Authentication: pre-shared-key Encryption: AES 256 Hashing: SHA 
DH: Group 5 Lifetime: 3600 8. Configure the pre-shared-key “NAKULISGOD” which you will use for the IPSEC connection. 9. Configure the IPSEC transform-set: Cipher: AES 256 ESP (Encapsulating Security Protcol) Hashing: SHA 10. Change the IPSEC security association lifetime to 1800 seconds. 11. You need to encrypt traffic from Router R1’s Loopback0 interface destined to R2’s Loopback0 interface, create the correct access-list. 12. Create the correct crypto-map to finish the IPSEC configuration 13. Verify the IPSEC configuration, you can use the following show/debug commands: show crypto ipsec transform-set show crypto map show crypto ipsec sa debug crypto isakmp 14. Try a ping from Router R1’s Loopback0 interface destined to Router R2’s Loopback0 interface, if your configuration is correct then traffic should be encrypted.  
WireShark Outputs :      
The above 2 screenshots show the result of implementing IPSec. It is very clearly seen that ISAKMP and ESP ( protocol of IPSec) have been implemented. Also the data is encrypted and hence cannot be read.  Using the command : show crypto ipsec transform-set, we will see the number of packets encapsulated, encrypted, decrypted and decapsulated.        
2) GRE Tunnel Basic   
This creates a tunnel between the source router R2 and destination router R3. The packet is sent from R2 to R3. Central router R1 has no information about anything happening and cannot see the contents of the packet travelling through the GRE tunnel.   
Steps- 1. Configure all IP addresses as specified in the topology picture 2. Configure a loopback interface on Router R2 and R3 3. R2: Loopback0: 1.1.1.1 /24 4. R3: Loopback0: 3.3.3.3 /24 5. Configure EIGRP AS1 on all 3 routers and advertise the 192.168.12.0 and 192.168.23.0 network 6. Ensure Router R2 and R3 can ping each other 7. Configure a GRE tunnel between Router R2 and R3. 8. Configure the 192.168.13.0 /24 network on the GRE tunnel: R2: 192.168.13.1 R3: 192.168.13.3 9. Configure another loopback interface on Router R2 and R3: R2: Loopback1: 11.11.11.11 /24 R3: Loopback1: 33.33.33.33 /24 10. Configure OSPF and use network commands to advertise the network on the GRE tunnel 11. Advertise Loopback1 in OSPF on Router R2 and R3               
WireShark Outputs :   
Here, it is clearly seen that EIGRP and ICMP is used. The pinging steps are shown between the 2 loopback addresses. Also it uses IPv4. Here, packets are only encapsulated and de-encapsulated.     
3) GRE over IPSEC Configuring an IPSEC tunnel and running GRE over it.     
     Steps- 1. Configure all IP addresses as specified in the topology picture Router R2 and R3 have the following loopback interfaces; R2: Loopback1: 11.11.11.11 /24 2. R3: Loopback1: 33.33.33.33 /24 3. Configure EIGRP AS1 on all 3 routers, only advertise the 192.168.12.0 and 192.168.23.0 network, do not advertise the loopbacks 4. Ensure Router R2 and R3 can ping each other 
5. Configure a IPSEC tunnel between Router R2 and R3 6. Configure the 192.168.13.0 /24 network on the IPSEC tunnel: R2: 192.168.13.1 R3: 192.168.13.3 7. Configure static routes on router R2 and R3 so they can reach each other’s loopback1 interface through the Tunnel interface 8. Create an IKE Policy with the following parameters: 9. Authentication: pre-shared-key 10. Encryption: AES 256 Hashing: SHA DH: Group 5 Lifetime: 3600 11. Configure the pre-shared-key “NAKULISGOD” which you will use for the IPSEC connection. 12. Configure the IPSEC transform-set: Cipher: AES 256 ESP (Encapsulating Security Protcol) Hashing: SHA 13. Create the correct policy profile to finish the IPSEC configuration. 14. Verify the IPSEC configuration, you can use the following show/debug commands: show crypto ipsec transform-set show crypto map show crypto ipsec sa debug crypto isakmp  
WireShark Outputs :   
Here, ESP is implemented. The packets are encapsulated and encrypted and they pass through a tunnel where at the other end of the tunnel they are decrypted and de-encapsulated. 
The GRE over IPSEC VPN provides the following two main benefits 
1. Ability to perform dynamic routing over the VPN tunnel interface 2. Ability to allow multicast traffic through the tunnel.  
FUTURE WORK –  
1. Implementing a system where the transactions are recorded into a distributed public database known as the block chain. 2. Implementing a proof-of-work system called bitcoin mining  3. Showing how the network timestamps the transactions 4. Showing how a bitcoin mining device works 
REFERENCES – 
1. https://en.wikipedia.org/wiki/Bitcoin_network 2. https://en.wikipedia.org/wiki/Bitcoin 3. http://www.gns3.com/
By –  Nakul Ramakumar – 9820247814 
